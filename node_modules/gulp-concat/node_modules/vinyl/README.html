<p align="center">
  <a href="http://gulpjs.com">
    <img height="257" width="114" src="https://raw.githubusercontent.com/gulpjs/artwork/master/gulp-2x.png">
  </a>
</p>
<h1>vinyl</h1>
<p><a href="https://www.npmjs.com/package/vinyl"><img src="http://img.shields.io/npm/v/vinyl.svg" alt="NPM version"></a> <a href="https://www.npmjs.com/package/vinyl"><img src="http://img.shields.io/npm/dm/vinyl.svg" alt="Downloads"></a> <a href="https://travis-ci.org/gulpjs/vinyl"><img src="http://img.shields.io/travis/gulpjs/vinyl.svg?label=travis-ci" alt="Build Status"></a> <a href="https://ci.appveyor.com/project/gulpjs/vinyl"><img src="https://img.shields.io/appveyor/ci/gulpjs/vinyl.svg?label=appveyor" alt="AppVeyor Build Status"></a> <a href="https://coveralls.io/r/gulpjs/vinyl"><img src="http://img.shields.io/coveralls/gulpjs/vinyl/master.svg" alt="Coveralls Status"></a> <a href="https://gitter.im/gulpjs/gulp"><img src="https://badges.gitter.im/gulpjs/gulp.svg" alt="Gitter chat"></a></p>
<p>Virtual file format.</p>
<h2>What is Vinyl?</h2>
<p>Vinyl is a very simple metadata object that describes a file. When you think of a file, two attributes come to mind: <code>path</code> and <code>contents</code>. These are the main attributes on a Vinyl object. A file does not necessarily represent something on your computerâ€™s file system. You have files on S3, FTP, Dropbox, Box, CloudThingly.io and other services. Vinyl can be used to describe files from all of these sources.</p>
<h2>What is a Vinyl Adapter?</h2>
<p>While Vinyl provides a clean way to describe a file, we also need a way to access these files. Each file source needs what I call a &quot;Vinyl adapter&quot;. A Vinyl adapter simply exposes a <code>src(globs)</code> and a <code>dest(folder)</code> method. Each return a stream. The <code>src</code> stream produces Vinyl objects, and the <code>dest</code> stream consumes Vinyl objects. Vinyl adapters can expose extra methods that might be specific to their input/output medium, such as the <code>symlink</code> method <a href="https://github.com/gulpjs/vinyl-fs"><code>vinyl-fs</code></a> provides.</p>
<h2>Usage</h2>
<pre><code class="language-js"><span class="hljs-keyword">var</span> Vinyl = <span class="hljs-built_in">require</span>(<span class="hljs-string">'vinyl'</span>);

<span class="hljs-keyword">var</span> jsFile = <span class="hljs-keyword">new</span> Vinyl({
  <span class="hljs-attr">cwd</span>: <span class="hljs-string">'/'</span>,
  <span class="hljs-attr">base</span>: <span class="hljs-string">'/test/'</span>,
  <span class="hljs-attr">path</span>: <span class="hljs-string">'/test/file.js'</span>,
  <span class="hljs-attr">contents</span>: <span class="hljs-keyword">new</span> Buffer(<span class="hljs-string">'var x = 123'</span>)
});
</code></pre>
<h2>API</h2>
<h3><code>new Vinyl([options])</code></h3>
<p>The constructor is used to create a new instance of <code>Vinyl</code>. Each instance represents a separate file, directory or symlink.</p>
<p>All internally managed paths (<code>cwd</code>, <code>base</code>, <code>path</code>, <code>history</code>) are normalized and have trailing separators removed. See <a href="#normalization-and-concatenation">Normalization and concatenation</a> for more information.</p>
<p>Options may be passed upon instantiation to create a file with specific properties.</p>
<h4><code>options</code></h4>
<p>Options are not mutated by the constructor.</p>
<h5><code>options.cwd</code></h5>
<p>The current working directory of the file.</p>
<p>Type: <code>String</code></p>
<p>Default: <code>process.cwd()</code></p>
<h5><code>options.base</code></h5>
<p>Used for calculating the <code>relative</code> property. This is typically where a glob starts.</p>
<p>Type: <code>String</code></p>
<p>Default: <code>options.cwd</code></p>
<h5><code>options.path</code></h5>
<p>The full path to the file.</p>
<p>Type: <code>String</code></p>
<p>Default: <code>undefined</code></p>
<h5><code>options.history</code></h5>
<p>Stores the path history. If <code>options.path</code> and <code>options.history</code> are both passed, <code>options.path</code> is appended to <code>options.history</code>. All <code>options.history</code> paths are normalized by the <code>file.path</code> setter.</p>
<p>Type: <code>Array</code></p>
<p>Default: <code>[]</code> (or <code>[options.path]</code> if <code>options.path</code> is passed)</p>
<h5><code>options.stat</code></h5>
<p>The result of an <code>fs.stat</code> call. This is how you mark the file as a directory or symbolic link. See <a href="#isdirectory">isDirectory()</a>, <a href="#issymbolic">isSymbolic()</a> and <a href="http://nodejs.org/api/fs.html#fs_class_fs_stats">fs.Stats</a> for more information.</p>
<p>Type: <a href="http://nodejs.org/api/fs.html#fs_class_fs_stats"><code>fs.Stats</code></a></p>
<p>Default: <code>undefined</code></p>
<h5><code>options.contents</code></h5>
<p>The contents of the file.  If <code>options.contents</code> is a <a href="https://nodejs.org/api/stream.html#stream_stream"><code>Stream</code></a>, it is wrapped in a <a href="https://github.com/mcollina/cloneable-readable"><code>cloneable-readable</code></a> stream.</p>
<p>Type: <a href="https://nodejs.org/api/stream.html#stream_stream"><code>Stream</code></a>, <a href="https://nodejs.org/api/buffer.html#buffer_class_buffer"><code>Buffer</code></a>, or <code>null</code></p>
<p>Default: <code>null</code></p>
<h5><code>options.{custom}</code></h5>
<p>Any other option properties will be directly assigned to the new Vinyl object.</p>
<pre><code class="language-js"><span class="hljs-keyword">var</span> Vinyl = <span class="hljs-built_in">require</span>(<span class="hljs-string">'vinyl'</span>);

<span class="hljs-keyword">var</span> file = <span class="hljs-keyword">new</span> Vinyl({ <span class="hljs-attr">foo</span>: <span class="hljs-string">'bar'</span> });
file.foo === <span class="hljs-string">'bar'</span>; <span class="hljs-comment">// true</span>
</code></pre>
<h3>Instance methods</h3>
<p>Each Vinyl object will have instance methods. Every method will be available but may return differently based on what properties were set upon instantiation or modified since.</p>
<h4><code>file.isBuffer()</code></h4>
<p>Returns <code>true</code> if the file contents are a <a href="https://nodejs.org/api/buffer.html#buffer_class_buffer"><code>Buffer</code></a>, otherwise <code>false</code>.</p>
<h4><code>file.isStream()</code></h4>
<p>Returns <code>true</code> if the file contents are a <a href="https://nodejs.org/api/stream.html#stream_stream"><code>Stream</code></a>, otherwise <code>false</code>.</p>
<h4><code>file.isNull()</code></h4>
<p>Returns <code>true</code> if the file contents are <code>null</code>, otherwise <code>false</code>.</p>
<h4><code>file.isDirectory()</code></h4>
<p>Returns <code>true</code> if the file represents a directory, otherwise <code>false</code>.</p>
<p>A file is considered a directory when:</p>
<ul>
<li><code>file.isNull()</code> is <code>true</code></li>
<li><code>file.stat</code> is an object</li>
<li><code>file.stat.isDirectory()</code> returns <code>true</code></li>
</ul>
<p>When constructing a Vinyl object, pass in a valid <a href="http://nodejs.org/api/fs.html#fs_class_fs_stats"><code>fs.Stats</code></a> object via <code>options.stat</code>. If you are mocking the <a href="http://nodejs.org/api/fs.html#fs_class_fs_stats"><code>fs.Stats</code></a> object, you may need to stub the <code>isDirectory()</code> method.</p>
<h4><code>file.isSymbolic()</code></h4>
<p>Returns <code>true</code> if the file represents a symbolic link, otherwise <code>false</code>.</p>
<p>A file is considered symbolic when:</p>
<ul>
<li><code>file.isNull()</code> is <code>true</code></li>
<li><code>file.stat</code> is an object</li>
<li><code>file.stat.isSymbolicLink()</code> returns <code>true</code></li>
</ul>
<p>When constructing a Vinyl object, pass in a valid <a href="http://nodejs.org/api/fs.html#fs_class_fs_stats"><code>fs.Stats</code></a> object via <code>options.stat</code>. If you are mocking the <a href="http://nodejs.org/api/fs.html#fs_class_fs_stats"><code>fs.Stats</code></a> object, you may need to stub the <code>isSymbolicLink()</code> method.</p>
<h4><code>file.clone([options])</code></h4>
<p>Returns a new Vinyl object with all attributes cloned.</p>
<p><strong>By default custom attributes are cloned deeply.</strong></p>
<p>If <code>options</code> or <code>options.deep</code> is <code>false</code>, custom attributes will not be cloned deeply.</p>
<p>If <code>file.contents</code> is a <a href="https://nodejs.org/api/buffer.html#buffer_class_buffer"><code>Buffer</code></a> and <code>options.contents</code> is <code>false</code>, the <a href="https://nodejs.org/api/buffer.html#buffer_class_buffer"><code>Buffer</code></a> reference will be reused instead of copied.</p>
<h4><code>file.inspect()</code></h4>
<p>Returns a formatted-string interpretation of the Vinyl object. Automatically called by node's <code>console.log</code>.</p>
<h3>Instance properties</h3>
<p>Each Vinyl object will have instance properties. Some may be unavailable based on what properties were set upon instantiation or modified since.</p>
<h4><code>file.contents</code></h4>
<p>Gets and sets the contents of the file. If set to a <a href="https://nodejs.org/api/stream.html#stream_stream"><code>Stream</code></a>, it is wrapped in a <a href="https://github.com/mcollina/cloneable-readable"><code>cloneable-readable</code></a> stream.</p>
<p>Throws when set to any value other than a <a href="https://nodejs.org/api/stream.html#stream_stream"><code>Stream</code></a>, a <a href="https://nodejs.org/api/buffer.html#buffer_class_buffer"><code>Buffer</code></a> or <code>null</code>.</p>
<p>Type: <a href="https://nodejs.org/api/stream.html#stream_stream"><code>Stream</code></a>, <a href="https://nodejs.org/api/buffer.html#buffer_class_buffer"><code>Buffer</code></a> or <code>null</code></p>
<h4><code>file.cwd</code></h4>
<p>Gets and sets current working directory. Will always be normalized and have trailing separators removed.</p>
<p>Throws when set to any value other than non-empty strings.</p>
<p>Type: <code>String</code></p>
<h4><code>file.base</code></h4>
<p>Gets and sets base directory. Used for relative pathing (typically where a glob starts).
When <code>null</code> or <code>undefined</code>, it simply proxies the <code>file.cwd</code> property. Will always be normalized and have trailing separators removed.</p>
<p>Throws when set to any value other than non-empty strings or <code>null</code>/<code>undefined</code>.</p>
<p>Type: <code>String</code></p>
<h4><code>file.path</code></h4>
<p>Gets and sets the absolute pathname string or <code>undefined</code>. Setting to a different value appends the new path to <code>file.history</code>. If set to the same value as the current path, it is ignored. All new values are normalized and have trailing separators removed.</p>
<p>Throws when set to any value other than a string.</p>
<p>Type: <code>String</code></p>
<h4><code>file.history</code></h4>
<p>Array of <code>file.path</code> values the Vinyl object has had, from <code>file.history[0]</code> (original) through <code>file.history[file.history.length - 1]</code> (current). <code>file.history</code> and its elements should normally be treated as read-only and only altered indirectly by setting <code>file.path</code>.</p>
<p>Type: <code>Array</code></p>
<h4><code>file.relative</code></h4>
<p>Gets the result of <code>path.relative(file.base, file.path)</code>.</p>
<p>Throws when set or when <code>file.path</code> is not set.</p>
<p>Type: <code>String</code></p>
<p>Example:</p>
<pre><code class="language-js"><span class="hljs-keyword">var</span> file = <span class="hljs-keyword">new</span> File({
  <span class="hljs-attr">cwd</span>: <span class="hljs-string">'/'</span>,
  <span class="hljs-attr">base</span>: <span class="hljs-string">'/test/'</span>,
  <span class="hljs-attr">path</span>: <span class="hljs-string">'/test/file.js'</span>
});

<span class="hljs-built_in">console</span>.log(file.relative); <span class="hljs-comment">// file.js</span>
</code></pre>
<h4><code>file.dirname</code></h4>
<p>Gets and sets the dirname of <code>file.path</code>. Will always be normalized and have trailing separators removed.</p>
<p>Throws when <code>file.path</code> is not set.</p>
<p>Type: <code>String</code></p>
<p>Example:</p>
<pre><code class="language-js"><span class="hljs-keyword">var</span> file = <span class="hljs-keyword">new</span> File({
  <span class="hljs-attr">cwd</span>: <span class="hljs-string">'/'</span>,
  <span class="hljs-attr">base</span>: <span class="hljs-string">'/test/'</span>,
  <span class="hljs-attr">path</span>: <span class="hljs-string">'/test/file.js'</span>
});

<span class="hljs-built_in">console</span>.log(file.dirname); <span class="hljs-comment">// /test</span>

file.dirname = <span class="hljs-string">'/specs'</span>;

<span class="hljs-built_in">console</span>.log(file.dirname); <span class="hljs-comment">// /specs</span>
<span class="hljs-built_in">console</span>.log(file.path); <span class="hljs-comment">// /specs/file.js</span>
</code></pre>
<h4><code>file.basename</code></h4>
<p>Gets and sets the basename of <code>file.path</code>.</p>
<p>Throws when <code>file.path</code> is not set.</p>
<p>Type: <code>String</code></p>
<p>Example:</p>
<pre><code class="language-js"><span class="hljs-keyword">var</span> file = <span class="hljs-keyword">new</span> File({
  <span class="hljs-attr">cwd</span>: <span class="hljs-string">'/'</span>,
  <span class="hljs-attr">base</span>: <span class="hljs-string">'/test/'</span>,
  <span class="hljs-attr">path</span>: <span class="hljs-string">'/test/file.js'</span>
});

<span class="hljs-built_in">console</span>.log(file.basename); <span class="hljs-comment">// file.js</span>

file.basename = <span class="hljs-string">'file.txt'</span>;

<span class="hljs-built_in">console</span>.log(file.basename); <span class="hljs-comment">// file.txt</span>
<span class="hljs-built_in">console</span>.log(file.path); <span class="hljs-comment">// /test/file.txt</span>
</code></pre>
<h4><code>file.stem</code></h4>
<p>Gets and sets stem (filename without suffix) of <code>file.path</code>.</p>
<p>Throws when <code>file.path</code> is not set.</p>
<p>Type: <code>String</code></p>
<p>Example:</p>
<pre><code class="language-js"><span class="hljs-keyword">var</span> file = <span class="hljs-keyword">new</span> File({
  <span class="hljs-attr">cwd</span>: <span class="hljs-string">'/'</span>,
  <span class="hljs-attr">base</span>: <span class="hljs-string">'/test/'</span>,
  <span class="hljs-attr">path</span>: <span class="hljs-string">'/test/file.js'</span>
});

<span class="hljs-built_in">console</span>.log(file.stem); <span class="hljs-comment">// file</span>

file.stem = <span class="hljs-string">'foo'</span>;

<span class="hljs-built_in">console</span>.log(file.stem); <span class="hljs-comment">// foo</span>
<span class="hljs-built_in">console</span>.log(file.path); <span class="hljs-comment">// /test/foo.js</span>
</code></pre>
<h4><code>file.extname</code></h4>
<p>Gets and sets extname of <code>file.path</code>.</p>
<p>Throws when <code>file.path</code> is not set.</p>
<p>Type: <code>String</code></p>
<p>Example:</p>
<pre><code class="language-js"><span class="hljs-keyword">var</span> file = <span class="hljs-keyword">new</span> File({
  <span class="hljs-attr">cwd</span>: <span class="hljs-string">'/'</span>,
  <span class="hljs-attr">base</span>: <span class="hljs-string">'/test/'</span>,
  <span class="hljs-attr">path</span>: <span class="hljs-string">'/test/file.js'</span>
});

<span class="hljs-built_in">console</span>.log(file.extname); <span class="hljs-comment">// .js</span>

file.extname = <span class="hljs-string">'.txt'</span>;

<span class="hljs-built_in">console</span>.log(file.extname); <span class="hljs-comment">// .txt</span>
<span class="hljs-built_in">console</span>.log(file.path); <span class="hljs-comment">// /test/file.txt</span>
</code></pre>
<h4><code>file.symlink</code></h4>
<p>Gets and sets the path where the file points to if it's a symbolic link. Will always be normalized and have trailing separators removed.</p>
<p>Throws when set to any value other than a string.</p>
<p>Type: <code>String</code></p>
<h3><code>Vinyl.isVinyl(file)</code></h3>
<p>Static method used for checking if an object is a Vinyl file. Use this method instead of <code>instanceof</code>.</p>
<p>Takes an object and returns <code>true</code> if it is a Vinyl file, otherwise returns <code>false</code>.</p>
<p><strong>Note: This method uses an internal flag that some older versions of Vinyl didn't expose.</strong></p>
<p>Example:</p>
<pre><code class="language-js"><span class="hljs-keyword">var</span> Vinyl = <span class="hljs-built_in">require</span>(<span class="hljs-string">'vinyl'</span>);

<span class="hljs-keyword">var</span> file = <span class="hljs-keyword">new</span> Vinyl();
<span class="hljs-keyword">var</span> notAFile = {};

Vinyl.isVinyl(file); <span class="hljs-comment">// true</span>
Vinyl.isVinyl(notAFile); <span class="hljs-comment">// false</span>
</code></pre>
<h3><code>Vinyl.isCustomProp(property)</code></h3>
<p>Static method used by Vinyl when setting values inside the constructor or when copying properties in <code>file.clone()</code>.</p>
<p>Takes a string <code>property</code> and returns <code>true</code> if the property is not used internally, otherwise returns <code>false</code>.</p>
<p>This method is usefuly for inheritting from the Vinyl constructor. Read more in <a href="#extending-vinyl">Extending Vinyl</a>.</p>
<p>Example:</p>
<pre><code class="language-js"><span class="hljs-keyword">var</span> Vinyl = <span class="hljs-built_in">require</span>(<span class="hljs-string">'vinyl'</span>);

Vinyl.isCustomProp(<span class="hljs-string">'sourceMap'</span>); <span class="hljs-comment">// true</span>
Vinyl.isCustomProp(<span class="hljs-string">'path'</span>); <span class="hljs-comment">// false -&gt; internal getter/setter</span>
</code></pre>
<h2>Normalization and concatenation</h2>
<p>Since all properties are normalized in their setters, you can just concatenate with <code>/</code>, and normalization takes care of it properly on all platforms.</p>
<p>Example:</p>
<pre><code class="language-js"><span class="hljs-keyword">var</span> file = <span class="hljs-keyword">new</span> File();
file.path = <span class="hljs-string">'/'</span> + <span class="hljs-string">'test'</span> + <span class="hljs-string">'/'</span> + <span class="hljs-string">'foo.bar'</span>;

<span class="hljs-built_in">console</span>.log(file.path);
<span class="hljs-comment">// posix =&gt; /test/foo.bar</span>
<span class="hljs-comment">// win32 =&gt; \\test\\foo.bar</span>
</code></pre>
<p>But never concatenate with <code>\</code>, since that is a valid filename character on posix system.</p>
<h2>Extending Vinyl</h2>
<p>When extending Vinyl into your own class with extra features, you need to think about a few things.</p>
<p>When you have your own properties that are managed internally, you need to extend the static <code>isCustomProp</code> method to return <code>false</code> when one of these properties is queried.</p>
<pre><code class="language-js"><span class="hljs-keyword">var</span> Vinyl = <span class="hljs-built_in">require</span>(<span class="hljs-string">'vinyl'</span>);

<span class="hljs-keyword">var</span> builtInProps = [<span class="hljs-string">'foo'</span>, <span class="hljs-string">'_foo'</span>];

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SuperFile</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Vinyl</span> </span>{
  <span class="hljs-keyword">constructor</span>(options) {
    <span class="hljs-keyword">super</span>(options);
    <span class="hljs-keyword">this</span>._foo = <span class="hljs-string">'example internal read-only value'</span>;
  }

  get foo() {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._foo;
  }

  <span class="hljs-keyword">static</span> isCustomProp(name) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">super</span>.isCustomProp(name) &amp;&amp; builtInProps.indexOf(name) === <span class="hljs-number">-1</span>;
  }
}
</code></pre>
<p>This makes properties <code>foo</code> and <code>_foo</code> ignored when cloning, and when passed in options to <code>constructor(options)</code> so they don't get assigned to the new object.</p>
<p>Same goes for <code>clone()</code>. If you have your own internal stuff that needs special handling during cloning, you should extend it to do so.</p>
<h2>License</h2>
<p>MIT</p>
